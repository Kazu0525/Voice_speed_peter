<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TypeVoice Analytics - éŸ³å£°å…¥åŠ›ãƒ»ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ç”Ÿç”£æ€§æ¸¬å®šãƒ„ãƒ¼ãƒ«</title>
<style>
* {
margin: 0;
padding: 0;
box-sizing: border-box;
}

body {
font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
min-height: 100vh;
padding: 20px;
}

.container {
max-width: 1200px;
margin: 0 auto;
background: white;
border-radius: 20px;
box-shadow: 0 20px 40px rgba(0,0,0,0.1);
overflow: hidden;
}

.header {
background: linear-gradient(135deg, #4f46e5 0%, #7c3aed 100%);
color: white;
padding: 30px;
text-align: center;
}

.header h1 {
font-size: 2.5rem;
margin-bottom: 10px;
font-weight: 700;
}

.header p {
font-size: 1.1rem;
opacity: 0.9;
}

.main-content {
padding: 40px;
}

.test-section {
background: #f8fafc;
border-radius: 15px;
padding: 30px;
margin-bottom: 30px;
border: 2px solid #e2e8f0;
transition: all 0.3s ease;
}

.test-section:hover {
border-color: #4f46e5;
box-shadow: 0 10px 25px rgba(79, 70, 229, 0.1);
}

.test-section h2 {
color: #1e293b;
font-size: 1.8rem;
margin-bottom: 20px;
display: flex;
align-items: center;
gap: 10px;
}

.test-icon {
width: 30px;
height: 30px;
background: linear-gradient(135deg, #4f46e5, #7c3aed);
border-radius: 50%;
display: flex;
align-items: center;
justify-content: center;
color: white;
font-weight: bold;
}

.sample-text {
background: white;
border: 2px solid #e2e8f0;
border-radius: 10px;
padding: 20px;
margin-bottom: 20px;
font-size: 1.1rem;
line-height: 1.6;
box-shadow: 0 4px 6px rgba(0,0,0,0.05);
}

.input-area {
width: 100%;
min-height: 120px;
border: 2px solid #e2e8f0;
border-radius: 10px;
padding: 15px;
font-size: 1rem;
font-family: inherit;
resize: vertical;
transition: border-color 0.3s ease;
}

.input-area:focus {
outline: none;
border-color: #4f46e5;
box-shadow: 0 0 0 3px rgba(79, 70, 229, 0.1);
}

.controls {
display: flex;
gap: 15px;
margin-top: 20px;
flex-wrap: wrap;
}

.btn {
padding: 12px 24px;
border: none;
border-radius: 8px;
font-size: 1rem;
font-weight: 600;
cursor: pointer;
transition: all 0.3s ease;
display: flex;
align-items: center;
gap: 8px;
}

.btn-primary {
background: linear-gradient(135deg, #4f46e5, #7c3aed);
color: white;
}

.btn-primary:hover:not(:disabled) {
transform: translateY(-2px);
box-shadow: 0 8px 25px rgba(79, 70, 229, 0.3);
}

.btn-secondary {
background: #f1f5f9;
color: #475569;
border: 2px solid #e2e8f0;
}

.btn-secondary:hover {
background: #e2e8f0;
}

.btn-danger {
background: #ef4444;
color: white;
}

.btn-danger:hover {
background: #dc2626;
}

.btn:disabled {
opacity: 0.6;
cursor: not-allowed;
}

.timer {
font-size: 2rem;
font-weight: bold;
text-align: center;
margin: 20px 0;
color: #4f46e5;
}

.countdown {
font-size: 3rem;
color: #ef4444;
}

.results {
background: linear-gradient(135deg, #10b981, #059669);
color: white;
border-radius: 15px;
padding: 25px;
margin-top: 20px;
display: none;
}

.results h3 {
font-size: 1.5rem;
margin-bottom: 15px;
text-align: center;
}

.results-grid {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
gap: 15px;
}

.result-item {
background: rgba(255,255,255,0.2);
padding: 15px;
border-radius: 10px;
text-align: center;
}

.result-value {
font-size: 2rem;
font-weight: bold;
margin-bottom: 5px;
}

.result-label {
font-size: 0.9rem;
opacity: 0.9;
}

.comparison {
background: #fef3c7;
border: 2px solid #f59e0b;
border-radius: 15px;
padding: 25px;
margin-top: 30px;
display: none;
}

.comparison h3 {
color: #92400e;
font-size: 1.5rem;
margin-bottom: 15px;
text-align: center;
}

.voice-support {
background: #dbeafe;
border: 2px solid #3b82f6;
border-radius: 10px;
padding: 15px;
margin-bottom: 20px;
}

.voice-support p {
color: #1e40af;
font-weight: 500;
}

.status-indicator {
display: inline-block;
width: 12px;
height: 12px;
border-radius: 50%;
margin-right: 8px;
}

.status-ready { background-color: #10b981; }
.status-recording { background-color: #ef4444; animation: pulse 1s infinite; }
.status-processing { background-color: #f59e0b; }

@keyframes pulse {
0% { opacity: 1; }
50% { opacity: 0.5; }
100% { opacity: 1; }
}

.progress-bar {
width: 100%;
height: 8px;
background-color: #e2e8f0;
border-radius: 4px;
overflow: hidden;
margin: 10px 0;
}

.progress-fill {
height: 100%;
background: linear-gradient(90deg, #4f46e5, #7c3aed);
width: 0%;
transition: width 0.1s ease;
}

@media (max-width: 768px) {
.header h1 {
font-size: 2rem;
}

.main-content {
padding: 20px;
}

.controls {
flex-direction: column;
}

.btn {
justify-content: center;
}
}
</style>
</head>
<body>
<div class="container">
<div class="header">
<h1>ğŸ¯ TypeVoice Analytics</h1>
<p>éŸ³å£°å…¥åŠ›ã¨ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ã®ç”Ÿç”£æ€§ã‚’ç§‘å­¦çš„ã«æ¸¬å®šãƒ»æ¯”è¼ƒ</p>
</div>

<div class="main-content">
<!-- éŸ³å£°å…¥åŠ›ãƒ†ã‚¹ãƒˆ -->
<div class="test-section">
<h2>
<div class="test-icon">ğŸ¤</div>
éŸ³å£°å…¥åŠ›ãƒ†ã‚¹ãƒˆ
</h2>

<div class="voice-support">
<p>
<span class="status-indicator status-ready" id="voiceStatus"></span>
ğŸ“¢ ãƒ–ãƒ©ã‚¦ã‚¶ã®ãƒã‚¤ã‚¯è¨±å¯ãŒå¿…è¦ã§ã™ã€‚ã€Œãƒã‚¤ã‚¯ã®èªè¨¼ã€ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨è¨±å¯ã‚’æ±‚ã‚ã‚‰ã‚Œã¾ã™ã€‚
</p>
</div>

<button class="btn btn-primary" id="micAuthBtn">ãƒã‚¤ã‚¯ã®èªè¨¼</button>
<p id="micAuthStatus"></p>

<div class="sample-text" id="voiceSampleText">
èª²é¡Œæ–‡ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...
</div>

<textarea class="input-area" id="voiceInput"
placeholder="éŸ³å£°å…¥åŠ›çµæœãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ï¼ˆæ‰‹å‹•ç·¨é›†ã‚‚å¯èƒ½ï¼‰..."></textarea>

<div class="progress-bar">
<div class="progress-fill" id="voiceProgress"></div>
</div>

<div class="timer" id="voiceTimer">æº–å‚™å®Œäº†</div>

<div class="controls">
<button class="btn btn-primary" id="voiceStartBtn">
ğŸ¤ é–‹å§‹
</button>
<button class="btn btn-danger" id="voiceStopBtn" style="display: none;">
â¹ï¸ åœæ­¢
</button>
<button class="btn btn-secondary" id="voiceResetBtn">
ğŸ”„ ãƒªã‚»ãƒƒãƒˆ
</button>
</div>

<div class="results" id="voiceResults">
<h3>ğŸ¤ éŸ³å£°å…¥åŠ›ãƒ†ã‚¹ãƒˆçµæœ</h3>
<div class="results-grid">
<div class="result-item">
<div class="result-value" id="voiceSpeed">0</div>
<div class="result-label">æ–‡å­—/åˆ†</div>
</div>
<div class="result-item">
<div class="result-value" id="voiceAccuracy">0%</div>
<div class="result-label">æ­£ç¢ºç‡</div>
</div>
<div class="result-item">
<div class="result-value" id="voiceErrors">0</div>
<div class="result-label">èª¤èªè­˜æ•°</div>
</div>
</div>
</div>
</div>

<!-- ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ãƒ†ã‚¹ãƒˆ -->
<div class="test-section">
<h2>
<div class="test-icon">âŒ¨ï¸</div>
ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ãƒ†ã‚¹ãƒˆ
</h2>

<div class="sample-text" id="typingSampleText">
èª²é¡Œæ–‡ãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™...
</div>

<textarea class="input-area" id="typingInput"
placeholder="ã“ã“ã«ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ã—ã¦ãã ã•ã„..."></textarea>

<div class="progress-bar">
<div class="progress-fill" id="typingProgress"></div>
</div>

<div class="timer" id="typingTimer">æº–å‚™å®Œäº†</div>

<div class="controls">
<button class="btn btn-primary" id="typingStartBtn">
âŒ¨ï¸ é–‹å§‹
</button>
<button class="btn btn-danger" id="typingStopBtn" style="display: none;">
â¹ï¸ åœæ­¢
</button>
<button class="btn btn-secondary" id="typingResetBtn">
ğŸ”„ ãƒªã‚»ãƒƒãƒˆ
</button>
</div>

<div class="results" id="typingResults">
<h3>âŒ¨ï¸ ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ãƒ†ã‚¹ãƒˆçµæœ</h3>
<div class="results-grid">
<div class="result-item">
<div class="result-value" id="typingSpeed">0</div>
<div class="result-label">æ–‡å­—/åˆ†</div>
</div>
<div class="result-item">
<div class="result-value" id="typingAccuracy">0%</div>
<div class="result-label">æ­£ç¢ºç‡</div>
</div>
<div class="result-item">
<div class="result-value" id="typingErrors">0</div>
<div class="result-label">èª¤å…¥åŠ›æ•°</div>
</div>
</div>
</div>
</div>

<!-- æ¯”è¼ƒçµæœ -->
<div class="comparison" id="comparison">
<h3>ğŸ“Š éŸ³å£°å…¥åŠ› vs ã‚¿ã‚¤ãƒ”ãƒ³ã‚° æ¯”è¼ƒçµæœ</h3>
<div id="comparisonContent">
ä¸¡æ–¹ã®ãƒ†ã‚¹ãƒˆã‚’å®Œäº†ã™ã‚‹ã¨ã€è©³ç´°ãªæ¯”è¼ƒçµæœã‚’è¡¨ç¤ºã—ã¾ã™ã€‚
</div>
</div>
</div>
</div>

<script>
// ã‚µãƒ³ãƒ—ãƒ«ãƒ†ã‚­ã‚¹ãƒˆï¼ˆ1800æ–‡å­—ç¨‹åº¦ï¼‰
const sampleTexts = [
"æœ¬æ—¥ã®ä¼šè­°ã§ã¯ã€æ¥å››åŠæœŸã®å£²ä¸Šç›®æ¨™ã«ã¤ã„ã¦è­°è«–ã—ã¾ã—ãŸã€‚å–¶æ¥­éƒ¨é–€ã‹ã‚‰ã¯å‰å¹´åŒæœŸæ¯”15%å¢—ã®ç›®æ¨™è¨­å®šãŒææ¡ˆã•ã‚Œã€ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°éƒ¨é–€ã¨ã®é€£æºå¼·åŒ–ãŒé‡è¦ã§ã‚ã‚‹ã“ã¨ãŒç¢ºèªã•ã‚Œã¾ã—ãŸã€‚ç‰¹ã«æ–°è¦é¡§å®¢é–‹æ‹“ã«ãŠã„ã¦ã€ãƒ‡ã‚¸ã‚¿ãƒ«ãƒãƒ¼ã‚±ãƒ†ã‚£ãƒ³ã‚°ã®æ´»ç”¨ã¨ã‚»ãƒ¼ãƒ«ã‚¹æ‹…å½“è€…ã®ã‚¹ã‚­ãƒ«ã‚¢ãƒƒãƒ—ãŒæ€¥å‹™ã¨ãªã£ã¦ã„ã¾ã™ã€‚ä»Šå¾Œã®ã‚¢ã‚¯ã‚·ãƒ§ãƒ³ãƒ—ãƒ©ãƒ³ã¨ã—ã¦ã€æœˆæ¬¡ã®é€²æ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ä¼šè­°ã‚’è¨­å®šã—ã€å„éƒ¨é–€ã®è²¬ä»»è€…ãŒå‚åŠ ã™ã‚‹ã“ã¨ã§ã€ç›®æ¨™é”æˆã«å‘ã‘ãŸå…·ä½“çš„ãªæ–½ç­–ã‚’æ¤œè¨ã—ã¦ã„ãã¾ã™ã€‚ã¾ãŸã€ç«¶åˆä»–ç¤¾ã®å‹•å‘åˆ†æã‚‚ä¸¦è¡Œã—ã¦å®Ÿæ–½ã—ã€å¸‚å ´ç’°å¢ƒã®å¤‰åŒ–ã«è¿…é€Ÿã«å¯¾å¿œã§ãã‚‹ä½“åˆ¶ã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†ã®åŠ¹ç‡åŒ–ã‚’å›³ã‚‹ãŸã‚ã€æ–°ã—ã„ã‚¿ã‚¹ã‚¯ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ ã®å°å…¥ã‚’æ¤œè¨ã—ã¦ãŠã‚Šã€ãƒãƒ¼ãƒ é–“ã®æƒ…å ±å…±æœ‰ã‚’ã‚ˆã‚Šå††æ»‘ã«ã™ã‚‹ä»•çµ„ã¿ã¥ãã‚Šã‚’é€²ã‚ã¦ã„ã¾ã™ã€‚é¡§å®¢æº€è¶³åº¦ã®å‘ä¸Šã‚’ç›®æŒ‡ã—ã€ã‚¢ãƒ•ã‚¿ãƒ¼ã‚µãƒ¼ãƒ“ã‚¹ä½“åˆ¶ã®è¦‹ç›´ã—ã¨æ”¹å–„ææ¡ˆã‚’è¡Œã„ã€é•·æœŸçš„ãªä¿¡é ¼é–¢ä¿‚ã®æ§‹ç¯‰ã«åŠªã‚ã¦ã„ã¾ã™ã€‚å¸‚å ´èª¿æŸ»ã®çµæœã€ç«¶åˆä»–ç¤¾ã«å¯¾ã™ã‚‹å„ªä½æ€§ã‚’ä¿ã¤ãŸã‚ã€æŠ€è¡“é©æ–°ã¸ã®æŠ•è³‡ã¨äººæè‚²æˆã®å¼·åŒ–ãŒä¸å¯æ¬ ã§ã‚ã‚‹ã“ã¨ãŒåˆ¤æ˜ã—ã¾ã—ãŸã€‚æ¥æœŸã«å‘ã‘ãŸæˆ¦ç•¥ç­–å®šã§ã¯ã€æŒç¶šå¯èƒ½ãªæˆé•·ãƒ¢ãƒ‡ãƒ«ã®æ§‹ç¯‰ã¨ã€ã‚°ãƒ­ãƒ¼ãƒãƒ«å±•é–‹ã‚’è¦–é‡ã«å…¥ã‚ŒãŸäº‹æ¥­è¨ˆç”»ã®ç«‹æ¡ˆã‚’é‡ç‚¹çš„ã«å–ã‚Šçµ„ã‚“ã§ã„ãã¾ã™ã€‚ç¤¾å†…ã®ãƒ‡ã‚¸ã‚¿ãƒ«åŒ–æ¨é€²ã«ã‚ˆã‚Šã€æ¥­å‹™ãƒ—ãƒ­ã‚»ã‚¹ã®è‡ªå‹•åŒ–ã¨åŠ¹ç‡åŒ–ã‚’å®Ÿç¾ã—ã€å¾“æ¥­å“¡ã®åƒãæ–¹æ”¹é©ã«ã‚‚è²¢çŒ®ã—ã¦ã„ãäºˆå®šã§ã™ã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã‹ã‚‰ã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’ç©æ¥µçš„ã«åé›†ã—ã€ã‚µãƒ¼ãƒ“ã‚¹å“è³ªã®ç¶™ç¶šçš„ãªæ”¹å–„ã«å–ã‚Šçµ„ã‚€ã“ã¨ã§ã€å¸‚å ´ã§ã®ç«¶äº‰åŠ›ã‚’ç¶­æŒå¼·åŒ–ã—ã¦ã„ãã¾ã™ã€‚",

"ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†ã«ãŠã„ã¦æœ€ã‚‚é‡è¦ãªã®ã¯ã€ã‚¹ãƒ†ãƒ¼ã‚¯ãƒ›ãƒ«ãƒ€ãƒ¼é–“ã®ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã§ã™ã€‚ãƒãƒ¼ãƒ å†…ã§ã®æƒ…å ±å…±æœ‰ã‚’å††æ»‘ã«ã™ã‚‹ãŸã‚ã€é€±æ¬¡ã®ã‚¹ã‚¿ãƒ³ãƒ‰ã‚¢ãƒƒãƒ—ãƒŸãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã¨æœˆæ¬¡ã®ã‚¹ãƒ—ãƒªãƒ³ãƒˆãƒ¬ãƒ“ãƒ¥ãƒ¼ã‚’å®Ÿæ–½ã—ã¦ã„ã¾ã™ã€‚ã¾ãŸã€ãƒªã‚¹ã‚¯ç®¡ç†ã®è¦³ç‚¹ã‹ã‚‰ã€æ½œåœ¨çš„ãªèª²é¡Œã®æ—©æœŸç™ºè¦‹ã¨å¯¾ç­–ç«‹æ¡ˆã«æ³¨åŠ›ã—ã¦ãŠã‚Šã€å“è³ªä¿è¨¼ä½“åˆ¶ã®å¼·åŒ–ã‚‚åŒæ™‚ã«é€²ã‚ã¦ã„ã¾ã™ã€‚ç´æœŸéµå®ˆã¨ã‚³ã‚¹ãƒˆæœ€é©åŒ–ã®ãƒãƒ©ãƒ³ã‚¹ã‚’å–ã‚ŠãªãŒã‚‰ã€ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã®è¦æ±‚ä»•æ§˜ã‚’æº€ãŸã™æˆæœç‰©ã®æä¾›ã‚’ç›®æŒ‡ã—ã¦ã„ã¾ã™ã€‚ä»Šå¾Œã¯è‡ªå‹•åŒ–ãƒ„ãƒ¼ãƒ«ã®å°å…¥ã«ã‚ˆã‚Šã€ä½œæ¥­åŠ¹ç‡ã®å‘ä¸Šã¨äººçš„ãƒŸã‚¹ã®å‰Šæ¸›ã‚’å›³ã‚‹äºˆå®šã§ã™ã€‚é–‹ç™ºãƒãƒ¼ãƒ ã§ã¯ã€ã‚¢ã‚¸ãƒ£ã‚¤ãƒ«é–‹ç™ºæ‰‹æ³•ã‚’æ¡ç”¨ã—ã€çŸ­æœŸé–“ã§ã®ã‚¤ãƒ†ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³é–‹ç™ºã«ã‚ˆã‚Šã€é¡§å®¢ãƒ‹ãƒ¼ã‚ºã«è¿…é€Ÿã«å¯¾å¿œã§ãã‚‹ä½“åˆ¶ã‚’æ§‹ç¯‰ã—ã¦ã„ã¾ã™ã€‚å“è³ªç®¡ç†ã«ãŠã„ã¦ã¯ã€ç¶™ç¶šçš„ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã¨ãƒ†ã‚¹ãƒˆè‡ªå‹•åŒ–ã«ã‚ˆã‚Šã€ãƒã‚°ã®æ—©æœŸç™ºè¦‹ã¨ä¿®æ­£ã‚’å®Ÿç¾ã—ã¦ã„ã¾ã™ã€‚ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®é€²æ—çŠ¶æ³ã¯ã€ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã‚’æ´»ç”¨ã—ã¦ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§å¯è¦–åŒ–ã—ã€é–¢ä¿‚è€…å…¨å“¡ãŒå¸¸ã«æœ€æ–°ã®çŠ¶æ³ã‚’æŠŠæ¡ã§ãã‚‹ã‚ˆã†ã«ã—ã¦ã„ã¾ã™ã€‚ãƒãƒ¼ãƒ ãƒ¡ãƒ³ãƒãƒ¼ã®ã‚¹ã‚­ãƒ«å‘ä¸Šã‚’æ”¯æ´ã™ã‚‹ãŸã‚ã€å®šæœŸçš„ãªç ”ä¿®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã¨å¤–éƒ¨ã‚»ãƒŸãƒŠãƒ¼ã¸ã®å‚åŠ ã‚’å¥¨åŠ±ã—ã€æŠ€è¡“åŠ›ã®åº•ä¸Šã’ã‚’å›³ã£ã¦ã„ã¾ã™ã€‚ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆã¨ã®å¯†æ¥ãªé€£æºã«ã‚ˆã‚Šã€è¦æ±‚ä»•æ§˜ã®å¤‰æ›´ã«ã‚‚æŸ”è»Ÿã«å¯¾å¿œã—ã€æœ€çµ‚çš„ãªæˆæœç‰©ã®å“è³ªå‘ä¸Šã«åŠªã‚ã¦ã„ã¾ã™ã€‚ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®æˆåŠŸè¦å› ã‚’åˆ†æã—ã€ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹ã¨ã—ã¦çµ„ç¹”å…¨ä½“ã§å…±æœ‰ã™ã‚‹ã“ã¨ã§ã€ä»Šå¾Œã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå®Ÿè¡Œèƒ½åŠ›ã®å‘ä¸Šã‚’ç›®æŒ‡ã—ã¦ã„ã¾ã™ã€‚",

"ä¼æ¥­ã®ãƒ‡ã‚¸ã‚¿ãƒ«ãƒˆãƒ©ãƒ³ã‚¹ãƒ•ã‚©ãƒ¼ãƒ¡ãƒ¼ã‚·ãƒ§ãƒ³æ¨é€²ã«ãŠã„ã¦ã€å¾“æ¥­å“¡ã®ITãƒªãƒ†ãƒ©ã‚·ãƒ¼å‘ä¸Šã¯ä¸å¯æ¬ ãªè¦ç´ ã§ã™ã€‚ç ”ä¿®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®å……å®ŸåŒ–ã¨å®Ÿè·µçš„ãªã‚¹ã‚­ãƒ«ç¿’å¾—æ©Ÿä¼šã®æä¾›ã«ã‚ˆã‚Šã€çµ„ç¹”å…¨ä½“ã®ç”Ÿç”£æ€§å‘ä¸Šã‚’å›³ã£ã¦ã„ã¾ã™ã€‚ã‚¯ãƒ©ã‚¦ãƒ‰ã‚µãƒ¼ãƒ“ã‚¹ã®æ´»ç”¨ã¨ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–ã®ä¸¡ç«‹ã€ãã—ã¦ãƒ‡ãƒ¼ã‚¿åˆ†æèƒ½åŠ›ã®å¼·åŒ–ãŒä»Šå¾Œã®ç«¶äº‰å„ªä½æ€§ã‚’å·¦å³ã™ã‚‹é‡è¦ãªãƒ•ã‚¡ã‚¯ã‚¿ãƒ¼ã¨ãªã‚Šã¾ã™ã€‚ã¾ãŸã€ãƒªãƒ¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯ç’°å¢ƒä¸‹ã§ã®ã‚³ãƒ©ãƒœãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ä¿ƒé€²ã®ãŸã‚ã€å„ç¨®ã‚³ãƒŸãƒ¥ãƒ‹ã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ„ãƒ¼ãƒ«ã®å°å…¥ã¨é‹ç”¨ãƒ«ãƒ¼ãƒ«ã®æ•´å‚™ã‚’é€²ã‚ã¦ãŠã‚Šã€åƒãæ–¹æ”¹é©ã®å®Ÿç¾ã«å‘ã‘ãŸå–ã‚Šçµ„ã¿ã‚’ç¶™ç¶šçš„ã«å®Ÿæ–½ã—ã¦ã„ã¾ã™ã€‚äººå·¥çŸ¥èƒ½ã¨ãƒ“ãƒƒã‚°ãƒ‡ãƒ¼ã‚¿æ´»ç”¨ã«ã‚ˆã‚‹æ¥­å‹™è‡ªå‹•åŒ–ã®æ¨é€²ã«ã‚ˆã‚Šã€å¾“æ¥ã®æ‰‹ä½œæ¥­ã«ã‚ˆã‚‹å‡¦ç†æ™‚é–“ã‚’å¤§å¹…ã«çŸ­ç¸®ã—ã€ã‚ˆã‚Šå‰µé€ çš„ãªæ¥­å‹™ã«é›†ä¸­ã§ãã‚‹ç’°å¢ƒã‚’æ•´å‚™ã—ã¦ã„ã¾ã™ã€‚ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–ã®å¼·åŒ–ã§ã¯ã€å¤šå±¤é˜²å¾¡ã‚·ã‚¹ãƒ†ãƒ ã®æ§‹ç¯‰ã¨å¾“æ¥­å“¡ã¸ã®ç¶™ç¶šçš„ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ•™è‚²ã«ã‚ˆã‚Šã€æƒ…å ±è³‡ç”£ã®ä¿è­·ã«ä¸‡å…¨ã‚’æœŸã—ã¦ã„ã¾ã™ã€‚ãƒ¢ãƒã‚¤ãƒ«ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆã®æˆ¦ç•¥ã«ã‚ˆã‚Šã€ã„ã¤ã§ã‚‚ã©ã“ã§ã‚‚æ¥­å‹™ã‚’ç¶™ç¶šã§ãã‚‹æŸ”è»Ÿãªåƒãæ–¹ã‚’å®Ÿç¾ã—ã€ãƒ¯ãƒ¼ã‚¯ãƒ©ã‚¤ãƒ•ãƒãƒ©ãƒ³ã‚¹ã®æ”¹å–„ã«ã‚‚è²¢çŒ®ã—ã¦ã„ã¾ã™ã€‚ãƒ‡ãƒ¼ã‚¿ãƒ‰ãƒªãƒ–ãƒ³ãªæ„æ€æ±ºå®šã‚’æ”¯æ´ã™ã‚‹ãŸã‚ã€å„ç¨®KPIã®å¯è¦–åŒ–ã¨åˆ†æãƒ„ãƒ¼ãƒ«ã®å°å…¥ã«ã‚ˆã‚Šã€çµŒå–¶åˆ¤æ–­ã®ç²¾åº¦å‘ä¸Šã‚’å›³ã£ã¦ã„ã¾ã™ã€‚é¡§å®¢ä½“é¨“ã®å‘ä¸Šã‚’ç›®æŒ‡ã—ã€ã‚ªãƒ ãƒ‹ãƒãƒ£ãƒãƒ«æˆ¦ç•¥ã®å±•é–‹ã«ã‚ˆã‚Šã€ã‚ã‚‰ã‚†ã‚‹ã‚¿ãƒƒãƒãƒã‚¤ãƒ³ãƒˆã§ã®ä¸€è²«ã—ãŸã‚µãƒ¼ãƒ“ã‚¹æä¾›ã‚’å®Ÿç¾ã—ã¦ã„ã¾ã™ã€‚æŒç¶šå¯èƒ½ãªæˆé•·ã‚’æ”¯ãˆã‚‹ãŸã‚ã€ç’°å¢ƒè² è·ã®è»½æ¸›ã¨ã‚³ã‚¹ãƒˆå‰Šæ¸›ã‚’ä¸¡ç«‹ã•ã›ã‚‹é©æ–°çš„ãªãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼ã®å°å…¥ã‚’ç©æ¥µçš„ã«æ¨é€²ã—ã¦ã„ã¾ã™ã€‚"
];

// ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
let currentSampleText = '';
let voiceTestActive = false;
let typingTestActive = false;
let voiceStartTime = 0;
let typingStartTime = 0;
let voiceResults = null;
let typingResults = null;
let voiceInterval = null;
let typingInterval = null;
let microphonePermissionGranted = false;

// ãƒã‚¤ã‚¯ã®èªè¨¼çŠ¶æ…‹ã‚’ä¿å­˜ã™ã‚‹
function isMicPreviouslyGranted() {
return localStorage.getItem('micGranted') === 'true';
}

function setMicGranted() {
localStorage.setItem('micGranted', 'true');
}

// åˆæœŸåŒ–
async function init() {
currentSampleText = sampleTexts[Math.floor(Math.random() * sampleTexts.length)];
document.getElementById('voiceSampleText').textContent = currentSampleText;
document.getElementById('typingSampleText').textContent = currentSampleText;

setupEventListeners();

// ä¿å­˜çŠ¶æ…‹ã«ã‚ˆã‚Šè¡¨ç¤ºã‚’å¤‰ãˆã‚‹
if (isMicPreviouslyGranted()) {
microphonePermissionGranted = true;
updateVoiceStatus('ready');
document.getElementById('micAuthStatus').textContent = 'âœ… ã™ã§ã«ãƒã‚¤ã‚¯ã®è¨±å¯ã¯å®Œäº†ã—ã¦ã„ã¾ã™ã€‚';
document.querySelector('.voice-support p').innerHTML = `
<span class="status-indicator status-ready" id="voiceStatus"></span>
âœ… ãƒã‚¤ã‚¯ã¯èªè¨¼æ¸ˆã¿ã§ã™ã€‚å¤–éƒ¨ãƒ„ãƒ¼ãƒ«ã‚’ã”ä½¿ç”¨ãã ã•ã„ã€‚
`;
}
}

// ãƒã‚¤ã‚¯è¨±å¯ã®äº‹å‰ç¢ºèª
async function handleMicAuth() {
const statusEl = document.getElementById('micAuthStatus');

if (isMicPreviouslyGranted()) {
statusEl.innerText = 'âœ… ã™ã§ã«ãƒã‚¤ã‚¯ã®è¨±å¯ã¯å®Œäº†ã—ã¦ã„ã¾ã™ã€‚';
microphonePermissionGranted = true;
return;
}

try {
const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
stream.getTracks().forEach(track => track.stop());

setMicGranted();
microphonePermissionGranted = true;
statusEl.innerText = 'âœ… ãƒã‚¤ã‚¯ãŒè¨±å¯ã•ã‚Œã¾ã—ãŸã€‚å¤–éƒ¨ãƒ„ãƒ¼ãƒ«ã§éŸ³å£°å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚';
updateVoiceStatus('ready');
document.querySelector('.voice-support p').innerHTML = `
<span class="status-indicator status-ready" id="voiceStatus"></span>
âœ… ãƒã‚¤ã‚¯èªè¨¼æ¸ˆã¿ã§ã™ã€‚WindowséŸ³å£°å…¥åŠ›ã‚„å¤–éƒ¨ãƒ„ãƒ¼ãƒ«ã‚’ã”ä½¿ç”¨ãã ã•ã„ã€‚
`;
} catch (err) {
microphonePermissionGranted = false;
statusEl.innerHTML = `
âŒ ãƒã‚¤ã‚¯ã®è¨±å¯ãŒã•ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚<br>
ã“ã®æ©Ÿèƒ½ã‚’ä½¿ã†ã«ã¯è¨±å¯ãŒå¿…è¦ã§ã™ã€‚<br>
<button class="btn btn-secondary" onclick="alert('ãƒ–ãƒ©ã‚¦ã‚¶ã®è¨­å®šã‹ã‚‰ãƒã‚¤ã‚¯ã‚’è¨±å¯ã—ã¦ãã ã•ã„')">ğŸ”§ è¨­å®šã‚’é–‹ã</button>
`;
}
}

// ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š
function setupEventListeners() {
document.getElementById('micAuthBtn').addEventListener('click', handleMicAuth);
document.getElementById('voiceStartBtn').addEventListener('click', startVoiceTest);
document.getElementById('voiceStopBtn').addEventListener('click', endVoiceTest);
document.getElementById('voiceResetBtn').addEventListener('click', resetVoiceTest);

document.getElementById('typingStartBtn').addEventListener('click', startTypingTest);
document.getElementById('typingStopBtn').addEventListener('click', endTypingTest);
document.getElementById('typingResetBtn').addEventListener('click', resetTypingTest);
}

// éŸ³å£°èªè­˜ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹æ›´æ–°
function updateVoiceStatus(status) {
const statusElement = document.getElementById('voiceStatus');
statusElement.className = `status-indicator status-${status}`;
}

// éŸ³å£°ãƒ†ã‚¹ãƒˆé–‹å§‹ï¼ˆä¿®æ­£ç‰ˆï¼‰
async function startVoiceTest() {
if (!isMicPreviouslyGranted()) {
alert('å…ˆã«ã€Œãƒã‚¤ã‚¯ã®èªè¨¼ã€ã‚’æŠ¼ã—ã¦è¨±å¯ã‚’ä¸ãˆã¦ãã ã•ã„ã€‚');
return;
}

// èªè­˜é–‹å§‹å‡¦ç†ã¯ä¸è¦ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒOSãƒ„ãƒ¼ãƒ«ã§å…¥åŠ›ã™ã‚‹å‰æ
document.getElementById('voiceInput').value = '';
document.getElementById('voiceResults').style.display = 'none';
document.getElementById('voiceStartBtn').style.display = 'none';
document.getElementById('voiceStopBtn').style.display = 'inline-flex';

startCountdown('voice', () => {
voiceTestActive = true;
voiceStartTime = Date.now();
document.getElementById('voiceInput').readOnly = false;
startTimer('voice');
startProgress('voice');

setTimeout(() => {
if (voiceTestActive) {
endVoiceTest();
}
}, 60000);
});
}

// éŸ³å£°ãƒ†ã‚¹ãƒˆçµ‚äº†
function endVoiceTest() {
if (!voiceTestActive) return;

voiceTestActive = false;

if (voiceInterval) {
clearInterval(voiceInterval);
}

// ä¸­é–“çµæœã‚¿ã‚°ã‚’å‰Šé™¤ã—ã¦ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
const voiceInput = document.getElementById('voiceInput');
voiceInput.value = voiceInput.value.replace(/\[ä¸­é–“\].*$/, '');
voiceInput.readOnly = true;

const endTime = Date.now();
const duration = (endTime - voiceStartTime) / 1000;
const inputText = voiceInput.value;

voiceResults = calculateResults(inputText, currentSampleText, duration);
displayResults('voice', voiceResults);

document.getElementById('voiceStartBtn').style.display = 'inline-flex';
document.getElementById('voiceStopBtn').style.display = 'none';
document.getElementById('voiceTimer').textContent = 'å®Œäº†';

updateVoiceStatus('ready');
checkComparison();
}

// ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ãƒ†ã‚¹ãƒˆé–‹å§‹
function startTypingTest() {
document.getElementById('typingInput').value = '';
document.getElementById('typingResults').style.display = 'none';
document.getElementById('typingStartBtn').style.display = 'none';
document.getElementById('typingStopBtn').style.display = 'inline-flex';

startCountdown('typing', () => {
typingTestActive = true;
typingStartTime = Date.now();
document.getElementById('typingInput').readOnly = false;
document.getElementById('typingInput').focus();
startTimer('typing');
startProgress('typing');

// 1åˆ†å¾Œã«è‡ªå‹•çµ‚äº†
setTimeout(() => {
if (typingTestActive) {
endTypingTest();
}
}, 60000);
});
}

// ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ãƒ†ã‚¹ãƒˆçµ‚äº†ï¼ˆæ”¹è‰¯ç‰ˆï¼‰
function endTypingTest() {
if (!typingTestActive) return;

typingTestActive = false;

if (typingInterval) {
clearInterval(typingInterval);
}

// å…¥åŠ›ã‚’ç¢ºå®šã•ã›ã‚‹
const typingInput = document.getElementById('typingInput');
typingInput.blur(); // ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚’å¤–ã—ã¦å…¥åŠ›ã‚’ç¢ºå®š

setTimeout(() => {
typingInput.readOnly = true;

const endTime = Date.now();
const duration = (endTime - typingStartTime) / 1000;
const inputText = typingInput.value;

typingResults = calculateResults(inputText, currentSampleText, duration);
displayResults('typing', typingResults);

document.getElementById('typingStartBtn').style.display = 'inline-flex';
document.getElementById('typingStopBtn').style.display = 'none';
document.getElementById('typingTimer').textContent = 'å®Œäº†';

checkComparison();
}, 100); // å°‘ã—å¾…ã£ã¦å…¥åŠ›ç¢ºå®šã‚’ç¢ºå®Ÿã«ã™ã‚‹
}

// ãƒ—ãƒ­ã‚°ãƒ¬ã‚¹ãƒãƒ¼é–‹å§‹
function startProgress(type) {
const progressElement = document.getElementById(type + 'Progress');
let progress = 0;

const progressInterval = setInterval(() => {
if ((type === 'voice' && !voiceTestActive) || (type === 'typing' && !typingTestActive)) {
clearInterval(progressInterval);
progressElement.style.width = '100%';
return;
}

progress += 100/60; // 60ç§’ã§100%
progressElement.style.width = Math.min(progress, 100) + '%';

if (progress >= 100) {
clearInterval(progressInterval);
}
}, 1000);
}

// ã‚«ã‚¦ãƒ³ãƒˆãƒ€ã‚¦ãƒ³ï¼ˆæ”¹è‰¯ç‰ˆï¼‰
function startCountdown(type, callback) {
let count = 3;
const timerElement = document.getElementById(type + 'Timer');

const countdownInterval = setInterval(() => {
timerElement.textContent = `é–‹å§‹ã¾ã§${count}ç§’`;
timerElement.className = 'timer countdown';

count--;

if (count < 0) {
clearInterval(countdownInterval);
timerElement.className = 'timer';
timerElement.textContent = 'ã‚¹ã‚¿ãƒ¼ãƒˆï¼';

setTimeout(() => {
callback();
}, 500);
}
}, 1000);
}

// ã‚¿ã‚¤ãƒãƒ¼
function startTimer(type) {
const timerElement = document.getElementById(type + 'Timer');
let seconds = 60;

const interval = setInterval(() => {
const minutes = Math.floor(seconds / 60);
const remainingSeconds = seconds % 60;
timerElement.textContent = `${minutes}:${remainingSeconds.toString().padStart(2, '0')}`;

seconds--;

if (seconds < 0 || (type === 'voice' && !voiceTestActive) || (type === 'typing' && !typingTestActive)) {
clearInterval(interval);
}
}, 1000);

if (type === 'voice') {
voiceInterval = interval;
} else {
typingInterval = interval;
}
}

// çµæœè¨ˆç®—ï¼ˆæ”¹è‰¯ç‰ˆ - ã‚¿ã‚¤ãƒ”ãƒ³ã‚°äºˆæ¸¬å¤‰æ›å¯¾å¿œï¼‰
function calculateResults(inputText, sampleText, duration) {
const inputChars = inputText.length;
const speed = Math.round((inputChars / duration) * 60);

// ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ã®å ´åˆã¯æ„å‘³çš„ãªæ¯”è¼ƒã‚’è¡Œã†
let errors = 0;

// å˜èªãƒ¬ãƒ™ãƒ«ã§ã®æ¯”è¼ƒï¼ˆäºˆæ¸¬å¤‰æ›ã‚’è€ƒæ…®ï¼‰
const inputWords = inputText.replace(/[ã€ã€‚ï¼ï¼Ÿ]/g, ' ').split(/\s+/).filter(word => word.length > 0);
const sampleWords = sampleText.replace(/[ã€ã€‚ï¼ï¼Ÿ]/g, ' ').split(/\s+/).filter(word => word.length > 0);

// ã‚ˆã‚ŠæŸ”è»Ÿãªèª¤å·®è¨ˆç®—
errors = calculateSmartErrors(inputWords, sampleWords);

const maxLength = Math.max(inputWords.length, sampleWords.length);
const accuracy = maxLength > 0 ? Math.max(0, Math.round(((maxLength - errors) / maxLength) * 100)) : 0;

return {
speed: speed,
accuracy: Math.max(0, accuracy),
errors: errors,
inputLength: inputChars,
duration: duration
};
}

// ã‚¹ãƒãƒ¼ãƒˆã‚¨ãƒ©ãƒ¼è¨ˆç®—ï¼ˆäºˆæ¸¬å¤‰æ›ã‚’è€ƒæ…®ï¼‰
function calculateSmartErrors(inputWords, sampleWords) {
let errors = 0;
const maxLength = Math.max(inputWords.length, sampleWords.length);

for (let i = 0; i < maxLength; i++) {
const inputWord = inputWords[i] || '';
const sampleWord = sampleWords[i] || '';

if (inputWord !== sampleWord) {
// åŒã˜æ„å‘³ã®å˜èªã‹ãƒã‚§ãƒƒã‚¯ï¼ˆä¾‹ï¼šã²ã‚‰ãŒãªãƒ»ã‚«ã‚¿ã‚«ãƒŠãƒ»æ¼¢å­—ã®é•ã„ï¼‰
if (!isSimilarWord(inputWord, sampleWord)) {
errors++;
}
}
}

return errors;
}

// é¡ä¼¼å˜èªåˆ¤å®šï¼ˆäºˆæ¸¬å¤‰æ›ã§ã®è¡¨è¨˜æºã‚Œã‚’è¨±å®¹ï¼‰
function isSimilarWord(word1, word2) {
if (!word1 || !word2) return false;

// å®Œå…¨ä¸€è‡´
if (word1 === word2) return true;

// ã²ã‚‰ãŒãªãƒ»ã‚«ã‚¿ã‚«ãƒŠå¤‰æ›ã§ã®ä¸€è‡´
const hiragana1 = toHiragana(word1);
const hiragana2 = toHiragana(word2);
if (hiragana1 === hiragana2) return true;

// é•·éŸ³è¨˜å·ã®é•ã„ã‚’è¨±å®¹ï¼ˆä¾‹ï¼šã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ãƒ¼ vs ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿ï¼‰
const normalized1 = word1.replace(/ãƒ¼/g, '');
const normalized2 = word2.replace(/ãƒ¼/g, '');
if (normalized1 === normalized2) return true;

// é€ã‚Šä»®åã®é•ã„ã‚’è¨±å®¹
if (word1.length > 2 && word2.length > 2) {
const base1 = word1.substring(0, word1.length - 1);
const base2 = word2.substring(0, word2.length - 1);
if (base1 === base2) return true;
}

return false;
}

// ã‚«ã‚¿ã‚«ãƒŠã‚’ã²ã‚‰ãŒãªã«å¤‰æ›
function toHiragana(str) {
return str.replace(/[\u30a1-\u30f6]/g, function(match) {
const chr = match.charCodeAt(0) - 0x60;
return String.fromCharCode(chr);
});
}

// çµæœè¡¨ç¤º
function displayResults(type, results) {
document.getElementById(type + 'Speed').textContent = results.speed;
document.getElementById(type + 'Accuracy').textContent = results.accuracy + '%';
document.getElementById(type + 'Errors').textContent = results.errors;
document.getElementById(type + 'Results').style.display = 'block';
}

// æ¯”è¼ƒçµæœãƒã‚§ãƒƒã‚¯
function checkComparison() {
if (voiceResults && typingResults) {
showComparison();
}
}

// æ¯”è¼ƒçµæœè¡¨ç¤º
function showComparison() {
const comparison = document.getElementById('comparison');
const content = document.getElementById('comparisonContent');

const speedDiff = voiceResults.speed - typingResults.speed;
const accuracyDiff = voiceResults.accuracy - typingResults.accuracy;

let recommendation = '';

if (speedDiff > 20 && accuracyDiff > -10) {
recommendation = 'ğŸ¤ éŸ³å£°å…¥åŠ›ãŒãŠã™ã™ã‚ï¼é€Ÿåº¦ãŒå¤§å¹…ã«å‘ä¸Šã—ã€ç²¾åº¦ã‚‚ååˆ†ã§ã™ã€‚';
} else if (speedDiff > 0 && accuracyDiff < -20) {
recommendation = 'âš–ï¸ éŸ³å£°å…¥åŠ›ã¯é€Ÿã„ã§ã™ãŒã€èª¤èªè­˜ãŒå¤šã‚ã§ã™ã€‚çŸ­æ–‡ã‚„ä¸‹æ›¸ãã«æ´»ç”¨ã—ã¾ã—ã‚‡ã†ã€‚';
} else if (speedDiff < -10) {
recommendation = 'âŒ¨ï¸ ã‚¿ã‚¤ãƒ”ãƒ³ã‚°ã®æ–¹ãŒåŠ¹ç‡çš„ã§ã™ã€‚éŸ³å£°å…¥åŠ›ã®ç·´ç¿’ã‚’ç¶šã‘ã¦å†ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã—ã¦ã¿ã¾ã—ã‚‡ã†ã€‚';
} else {
recommendation = 'ğŸ“Š ä¸¡æ–¹ã¨ã‚‚åŒç¨‹åº¦ã®æ€§èƒ½ã§ã™ã€‚ç”¨é€”ã«å¿œã˜ã¦ä½¿ã„åˆ†ã‘ã‚‹ã“ã¨ã‚’ãŠã™ã™ã‚ã—ã¾ã™ã€‚';
}

content.innerHTML = `
<div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 20px;">
<div style="background: rgba(79, 70, 229, 0.1); padding: 15px; border-radius: 10px;">
<h4 style="color: #4f46e5; margin-bottom: 10px;">ğŸ¤ éŸ³å£°å…¥åŠ›</h4>
<p>é€Ÿåº¦: ${voiceResults.speed} æ–‡å­—/åˆ†</p>
<p>ç²¾åº¦: ${voiceResults.accuracy}%</p>
<p>èª¤èªè­˜: ${voiceResults.errors} ç®‡æ‰€</p>
</div>
<div style="background: rgba(16, 185, 129, 0.1); padding: 15px; border-radius: 10px;">
<h4 style="color: #10b981; margin-bottom: 10px;">âŒ¨ï¸ ã‚¿ã‚¤ãƒ”ãƒ³ã‚°</h4>
<p>é€Ÿåº¦: ${typingResults.speed} æ–‡å­—/åˆ†</p>
<p>ç²¾åº¦: ${typingResults.accuracy}%</p>
<p>èª¤å…¥åŠ›: ${typingResults.errors} ç®‡æ‰€</p>
</div>
</div>

<div style="background: rgba(245, 158, 11, 0.1); padding: 20px; border-radius: 10px; text-align: center;">
<h4 style="color: #d97706; margin-bottom: 10px;">ğŸ’¡ ç”Ÿç”£æ€§å‘ä¸Šã®ãŸã‚ã®ã‚¢ãƒ‰ãƒã‚¤ã‚¹</h4>
<p style="font-size: 1.1rem; font-weight: 500;">${recommendation}</p>
</div>

<div style="margin-top: 20px; padding: 15px; background: rgba(99, 102, 241, 0.05); border-radius: 10px;">
<h4 style="color: #6366f1; margin-bottom: 10px;">ğŸ“ˆ è©³ç´°åˆ†æ</h4>
<p>é€Ÿåº¦å·®: ${speedDiff > 0 ? '+' : ''}${speedDiff} æ–‡å­—/åˆ† (éŸ³å£°å…¥åŠ›ãŒ${speedDiff > 0 ? 'é€Ÿã„' : 'é…ã„'})</p>
<p>ç²¾åº¦å·®: ${accuracyDiff > 0 ? '+' : ''}${accuracyDiff}% (éŸ³å£°å…¥åŠ›ãŒ${accuracyDiff > 0 ? 'æ­£ç¢º' : 'ä¸æ­£ç¢º'})</p>
</div>
`;

comparison.style.display = 'block';
}

// ãƒªã‚»ãƒƒãƒˆæ©Ÿèƒ½
function resetVoiceTest() {
voiceTestActive = false;

if (voiceInterval) {
clearInterval(voiceInterval);
}

document.getElementById('voiceInput').value = '';
document.getElementById('voiceInput').readOnly = false;
document.getElementById('voiceResults').style.display = 'none';
document.getElementById('voiceTimer').textContent = 'æº–å‚™å®Œäº†';
document.getElementById('voiceStartBtn').style.display = 'inline-flex';
document.getElementById('voiceStopBtn').style.display = 'none';
document.getElementById('voiceProgress').style.width = '0%';

updateVoiceStatus('ready');
voiceResults = null;
hideComparison();
}

function resetTypingTest() {
typingTestActive = false;

if (typingInterval) {
clearInterval(typingInterval);
}

document.getElementById('typingInput').value = '';
document.getElementById('typingInput').readOnly = false;
document.getElementById('typingResults').style.display = 'none';
document.getElementById('typingTimer').textContent = 'æº–å‚™å®Œäº†';
document.getElementById('typingStartBtn').style.display = 'inline-flex';
document.getElementById('typingStopBtn').style.display = 'none';
document.getElementById('typingProgress').style.width = '0%';

typingResults = null;
hideComparison();
}

function hideComparison() {
if (!voiceResults || !typingResults) {
document.getElementById('comparison').style.display = 'none';
}
}

// ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã®åˆæœŸåŒ–
window.addEventListener('load', init);
</script>
</body>
</html>

